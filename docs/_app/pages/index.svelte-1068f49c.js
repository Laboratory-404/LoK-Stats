var E=Object.defineProperty,$=Object.defineProperties;var v=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var R=(n,a,e)=>a in n?E(n,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[a]=e,w=(n,a)=>{for(var e in a||(a={}))I.call(a,e)&&R(n,e,a[e]);if(b)for(var e of b(a))B.call(a,e)&&R(n,e,a[e]);return n},L=(n,a)=>$(n,v(a));import{S as D,i as P,s as j,w as C,x as S,y as k,q as G,o as U,B as q,I as x,P as g,u as M}from"../chunks/vendor-ad1cfbc0.js";import{d as _}from"../chunks/stores-eb6a96cf.js";import{L as W}from"../chunks/Land-1870363f.js";const Y={MODE:"production",DEV:!1,PROD:!0,BASE_URL:"/_app/",API_ROOT:"https://api-lok-live.leagueofkingdoms.com/api"},V=5e3,z=1,F=100,H=n=>new Promise(a=>setTimeout(()=>a(),n)),J=async(n,a={},e)=>{let o=null,t;if(typeof AbortController=="function"){const{timeout:c=V}=a,r=new AbortController;o=setTimeout(()=>r.abort(),c),typeof e=="function"?t=await e(n,L(w({},a),{signal:r.signal})):t=await fetch(n,L(w({},a),{signal:r.signal}))}else typeof e=="function"?t=await e(n,a):t=await fetch(n,a);return o!==null&&clearTimeout(o),t},T=async(n,a={},e,o=z)=>{try{return await J(n,a,e)}catch(t){if(console.error(t),o===1)throw t;return await H(F),T(n,a,e,o-1)}},A=(n,a,e,o,t)=>T(`${Y.API_ROOT}/stat/land/contribution?landId=${n}&from=${a}&to=${e}`,t,o);function K(n){let a,e;return a=new W({props:{id:N,data:n[1],val:n[0],max:n[2]}}),{c(){C(a.$$.fragment)},l(o){S(a.$$.fragment,o)},m(o,t){k(a,o,t),e=!0},p(o,[t]){const c={};t&2&&(c.data=o[1]),t&1&&(c.val=o[0]),a.$set(c)},i(o){e||(G(a.$$.fragment,o),e=!0)},o(o){U(a.$$.fragment,o),e=!1},d(o){q(a,o)}}}let f="2022-03-22",m="2022-03-28",N=0;function Q(n,a,e){let o,t;x(n,_,l=>e(4,t=l));let c=[134223,134224,134225,133969,133968,133967,133711,133712,133713,133455,133456,133457,150949],r=0,y=c.length,O;if(Array.isArray(t.lands))if(t.lands.length===0)g(_,t.lands=[{start:f,end:m,data:{}}],t),t.lands.map((l,s)=>{l.start===f&&l.end===m&&c.map(async u=>{let d=await A(u,f,m).catch(h=>console.error(h)),i=await(d==null?void 0:d.json().catch(h=>console.error(h)));e(0,r++,r),typeof l.data=="undefined"&&g(_,t.lands[s].data={},t),g(_,t.lands[s].data[u]=i,t)})}),console.log("Loaded from server");else{let l=!1;t.lands.map(s=>{s.start===f&&s.end===m&&(l=!0)}),l?(t.lands.map((s,u)=>{s.start===f&&s.end===m&&(s.data&&Object.keys(s.data).length===0?(c.map(async d=>{let i=await A(d,f,m).catch(p=>console.error(p)),h=await(i==null?void 0:i.json().catch(p=>console.error(p)));e(0,r++,r),typeof s.data=="undefined"&&g(_,t.lands[u].data={},t),g(_,t.lands[u].data[d]=h,t)}),console.log("Loaded from server")):console.log("Loaded from cache"))}),r=y):(t.lands.push({start:f,end:m,data:{}}),t.lands.map((s,u)=>{s.start===f&&s.end===m&&c.map(async d=>{let i=await A(d,f,m).catch(p=>console.error(p)),h=await(i==null?void 0:i.json().catch(p=>console.error(p)));typeof s.data=="undefined"&&g(_,t.lands[u].data={},t),g(_,t.lands[u].data[d]=h,t)})}),r=y,console.log("Loaded from server"))}return M(()=>{var l,s;e(1,O=(s=(l=t==null?void 0:t.lands[0])==null?void 0:l.data[o])==null?void 0:s.contribution)}),o=134223,[r,O,y]}class et extends D{constructor(a){super();P(this,a,Q,K,j,{})}}export{et as default};
//# sourceMappingURL=index.svelte-1068f49c.js.map
