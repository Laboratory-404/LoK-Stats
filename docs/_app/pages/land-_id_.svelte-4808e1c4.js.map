{"version":3,"file":"land-_id_.svelte-4808e1c4.js","sources":["../../../../../src/routes/land-[id].svelte"],"sourcesContent":["<!--suppress JSUnusedAssignment -->\n\n<script context=\"module\">\n\texport const load = async ({ params }) => {\n\t\treturn {\n\t\t\tprops: { params }\n\t\t}\n\t}\n</script>\n\n<script>\n\timport { afterUpdate } from 'svelte'\n\timport { db } from '$lib/stores'\n\timport { getContributions } from '$lib/api'\n\timport Land from '$lib/components/Land.svelte'\n\n\texport let params\n\n\t$: id = params.id\n\tlet lands = [134223, 134224, 134225, 133969, 133968, 133967, 133711, 133712, 133713, 133455, 133456, 133457, 150949]\n\tlet val = 0\n\tlet max = lands.length\n\tlet start = '2022-03-22'\n\tlet end = '2022-03-28'\n\tlet data\n\n\tafterUpdate(() => {\n\t\tif (Array.isArray($db.lands))  {\n\t\t\tif ($db.lands.length === 0) {\n\t\t\t\t$db.lands = [{\n\t\t\t\t\tstart,\n\t\t\t\t\tend,\n\t\t\t\t\tdata: {}\n\t\t\t\t}]\n\n\t\t\t\t$db.lands.map((p, i) => {\n\t\t\t\t\tif (p.start === start && p.end === end) {\n\t\t\t\t\t\tlands.map(async land => {\n\t\t\t\t\t\t\tlet contributions_api = await getContributions(land, start, end).catch(error => console.error(error))\n\t\t\t\t\t\t\t// noinspection UnnecessaryLocalVariableJS\n\t\t\t\t\t\t\tlet contributions_data = await contributions_api?.json().catch(error => console.error(error))\n\n\t\t\t\t\t\t\tval++\n\n\t\t\t\t\t\t\tif (typeof p.data === 'undefined') {\n\t\t\t\t\t\t\t\t$db.lands[i].data = {}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t$db.lands[i].data[land] = contributions_data\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\tconsole.log('Loaded from server')\n\t\t\t} else {\n\t\t\t\tlet found = false\n\n\t\t\t\t$db.lands.map(p => {\n\t\t\t\t\tif (p.start === start && p.end === end) {\n\t\t\t\t\t\tfound = true\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\tif (found) {\n\t\t\t\t\t$db.lands.map((p, i) => {\n\t\t\t\t\t\tif (p.start === start && p.end === end) {\n\t\t\t\t\t\t\tif (p.data && Object.keys(p.data).length === 0) {\n\t\t\t\t\t\t\t\tlands.map(async land => {\n\t\t\t\t\t\t\t\t\tlet contributions_api = await getContributions(land, start, end).catch(error => console.error(error))\n\t\t\t\t\t\t\t\t\t// noinspection UnnecessaryLocalVariableJS\n\t\t\t\t\t\t\t\t\tlet contributions_data = await contributions_api?.json().catch(error => console.error(error))\n\n\t\t\t\t\t\t\t\t\tval++\n\n\t\t\t\t\t\t\t\t\tif (typeof p.data === 'undefined') {\n\t\t\t\t\t\t\t\t\t\t$db.lands[i].data = {}\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t$db.lands[i].data[land] = contributions_data\n\t\t\t\t\t\t\t\t})\n\n\t\t\t\t\t\t\t\tconsole.log('Loaded from server')\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tconsole.log('Loaded from cache')\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\n\t\t\t\t\tval = max\n\t\t\t\t} else {\n\t\t\t\t\t$db.lands.push({\n\t\t\t\t\t\tstart,\n\t\t\t\t\t\tend,\n\t\t\t\t\t\tdata: {}\n\t\t\t\t\t})\n\n\t\t\t\t\t$db.lands.map((p, i) => {\n\t\t\t\t\t\tif (p.start === start && p.end === end) {\n\t\t\t\t\t\t\tlands.map(async land => {\n\t\t\t\t\t\t\t\tlet contributions_api = await getContributions(land, start, end).catch(error => console.error(error))\n\t\t\t\t\t\t\t\t// noinspection UnnecessaryLocalVariableJS\n\t\t\t\t\t\t\t\tlet contributions_data = await contributions_api?.json().catch(error => console.error(error))\n\n\t\t\t\t\t\t\t\tif (typeof p.data === 'undefined') {\n\t\t\t\t\t\t\t\t\t$db.lands[i].data = {}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t$db.lands[i].data[land] = contributions_data\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\n\t\t\t\t\tval = max\n\n\t\t\t\t\tconsole.log('Loaded from server')\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// noinspection JSUnresolvedVariable\n\t\tdata = $db?.lands[0]?.data[id]?.contribution\n\t})\n</script>\n\n<Land {id} {data} {val} {max} />"],"names":[],"mappings":"wiBAGc,UAAgB,cAE3B,OAAS,eAiBP,GAAQ,aACR,EAAM,8DAPC,YAGP,GAAS,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,QACzG,EAAM,EACN,EAAM,EAAM,OAGZ,EAEJ,yBACK,MAAM,QAAQ,EAAI,UACjB,EAAI,MAAM,SAAW,MACxB,EAAI,QACH,QACA,MACA,aAGD,EAAI,MAAM,KAAK,EAAG,KACb,EAAE,QAAU,GAAS,EAAE,MAAQ,GAClC,EAAM,SAAU,QACX,QAA0B,GAAiB,EAAM,EAAO,GAAK,MAAM,GAAS,QAAQ,MAAM,IAE1F,OAA2B,kBAAmB,OAAO,MAAM,GAAS,QAAQ,MAAM,SAEtF,aAEW,GAAE,MAAS,iBACrB,EAAI,MAAM,GAAG,eAGd,EAAI,MAAM,GAAG,KAAK,GAAQ,SAK7B,QAAQ,IAAI,8BAER,GAAQ,GAEZ,EAAI,MAAM,IAAI,IACT,EAAE,QAAU,GAAS,EAAE,MAAQ,GAClC,GAAQ,MAIN,EACH,GAAI,MAAM,KAAK,EAAG,KACb,EAAE,QAAU,GAAS,EAAE,MAAQ,IAC9B,EAAE,MAAQ,OAAO,KAAK,EAAE,MAAM,SAAW,EAC5C,GAAM,SAAU,QACX,QAA0B,GAAiB,EAAM,EAAO,GAAK,MAAM,GAAS,QAAQ,MAAM,IAE1F,OAA2B,kBAAmB,OAAO,MAAM,GAAS,QAAQ,MAAM,SAEtF,aAEW,GAAE,MAAS,iBACrB,EAAI,MAAM,GAAG,eAGd,EAAI,MAAM,GAAG,KAAK,GAAQ,OAG3B,QAAQ,IAAI,uBAEZ,QAAQ,IAAI,4BAKf,EAAM,IAEN,GAAI,MAAM,MACT,QACA,MACA,UAGD,EAAI,MAAM,KAAK,EAAG,KACb,EAAE,QAAU,GAAS,EAAE,MAAQ,GAClC,EAAM,SAAU,QACX,QAA0B,GAAiB,EAAM,EAAO,GAAK,MAAM,GAAS,QAAQ,MAAM,IAE1F,OAA2B,kBAAmB,OAAO,MAAM,GAAS,QAAQ,MAAM,WAE3E,GAAE,MAAS,iBACrB,EAAI,MAAM,GAAG,eAGd,EAAI,MAAM,GAAG,KAAK,GAAQ,aAK7B,EAAM,GAEN,QAAQ,IAAI,2BAMf,EAAO,uBAAK,MAAM,KAAX,cAAe,KAAK,KAApB,cAAyB,+FAtG9B,EAAK,EAAO"}