var b=Object.defineProperty,P=Object.defineProperties;var k=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable;var v=(a,t,s)=>t in a?b(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,A=(a,t)=>{for(var s in t||(t={}))S.call(t,s)&&v(a,s,t[s]);if(R)for(var s of R(t))p.call(t,s)&&v(a,s,t[s]);return a},E=(a,t)=>P(a,k(t));import{V as O,S as B,i as K,s as N,K as H,C as T,e as D,c as Y,a as j,d as w,W as I,g as M,Q as G,L as U,M as V,N as F,z as J,q as Q,o as W,X as L,Y as $}from"./vendor-321789e9.js";import{d as h}from"./stores-b0039799.js";const m={MODE:"production",DEV:!1,PROD:!0,BASE_URL:"/_app/",API_ROOT:"https://api-lok-live.leagueofkingdoms.com/api",ETHERSCAN_API_ROOT:"https://api.etherscan.io/api",ETHERSCAN_API_KEY:"F9FJ7PFU1I1J22JQUAKXY8C2CQVMZGHRM3"},q=5e3,X=1,z=100,Z=a=>new Promise(t=>setTimeout(()=>t(),a)),x=async(a,t={},s)=>{let e=null,r;if(typeof AbortController=="function"){const{timeout:i=q}=t,l=new AbortController;e=setTimeout(()=>l.abort(),i),typeof s=="function"?r=await s(a,E(A({},t),{signal:l.signal})):r=await fetch(a,E(A({},t),{signal:l.signal}))}else typeof s=="function"?r=await s(a,t):r=await fetch(a,t);return e!==null&&clearTimeout(e),r},g=async(a,t={},s,e=X)=>{try{return await x(a,t,s)}catch(r){if(console.error(r),e===1)throw r;return await Z(z),g(a,t,s,e-1)}},C={getContractABI:(a,t,s)=>g(`${m.ETHERSCAN_API_ROOT}?module=contract&action=getabi&address=${a}&page=1&startblock=0&sort=asc&apikey=${m.ETHERSCAN_API_KEY}`,s,t),getBalance:(a,t,s,e)=>g(`${m.ETHERSCAN_API_ROOT}?module=account&action=tokenbalance&contractaddress=${a}&address=${t}&tag=latest&&apikey=${m.ETHERSCAN_API_KEY}`,e,s),getTransferEvents:(a,t,s=!1,e,r)=>g(`${m.ETHERSCAN_API_ROOT}?module=account&action=${s?"tokennfttx":"tokentx"}&contractaddress=${a}&address=${t}&apikey=${m.ETHERSCAN_API_KEY}`,r,e)},y=(a,t,s,e,r)=>g(`${m.API_ROOT}/stat/land/contribution?landId=${a}&from=${t}&to=${s}`,r,e),lt=async(a,t)=>{let s=O(h),e=a||s.wallet,r=t||s.contract,i=await C.getBalance(r,e).catch(o=>console.error(o)),l=await(i==null?void 0:i.json().catch(o=>console.error(o)));return(l==null?void 0:l.message)==="OK"&&(l==null?void 0:l.status)==="1"?parseInt(l==null?void 0:l.result):0},nt=async(a,t)=>{let s=[],e=O(h),r=a||e.wallet,i=t||e.contract,l=await C.getTransferEvents(i,r,!0).catch(c=>console.error(c)),o=await(l==null?void 0:l.json().catch(c=>console.error(c)));return o.message==="OK"&&o.status==="1"&&Array.isArray(o.result)&&o.result.map(({tokenName:c,tokenSymbol:f,tokenID:n})=>{c==="League of Kingdoms LAND"&&f==="LOKL"&&s.push(n)}),s},rt=(a,t,s)=>{let e=O(h),r=a||e.lands,i=t||e.start,l=s||e.end;if(Array.isArray(e.data))if(e.data.length===0)e.data=[{start:i,end:l,data:{}}],e.data.map((o,c)=>{o.start===i&&o.end===l&&r.map(async f=>{let n=await y(f,i,l).catch(u=>console.error(u)),d=await(n==null?void 0:n.json().catch(u=>console.error(u)));typeof o.data=="undefined"&&(e.data[c].data={}),e.data[c].data[f]=d,h.set(e)})}),console.log("Loaded from server");else{let o=!1;e.data.map(c=>{c.start===i&&c.end===l&&(o=!0)}),o?e.data.map((c,f)=>{c.start===i&&c.end===l&&(c.data&&Object.keys(c.data).length===0?(r.map(async n=>{let d=await y(n,i,l).catch(_=>console.error(_)),u=await(d==null?void 0:d.json().catch(_=>console.error(_)));typeof c.data=="undefined"&&(e.data[f].data={}),e.data[f].data[n]=u,h.set(e)}),console.log("Loaded from server")):console.log("Loaded from cache"))}):(e.data.push({start:i,end:l,data:{}}),e.data.map((c,f)=>{c.start===i&&c.end===l&&r.map(async n=>{let d=await y(n,i,l).catch(_=>console.error(_)),u=await(d==null?void 0:d.json().catch(_=>console.error(_)));typeof c.data=="undefined"&&(e.data[f].data={}),e.data[f].data[n]=u,h.set(e)})}),console.log("Loaded from server"))}};function tt(a){let t,s,e,r,i;const l=a[3].default,o=H(l,a,a[2],null);let c=[{class:s="box "+(a[0]?"aside":"")},a[1]],f={};for(let n=0;n<c.length;n+=1)f=T(f,c[n]);return{c(){t=D("div"),o&&o.c(),this.h()},l(n){t=Y(n,"DIV",{class:!0});var d=j(t);o&&o.l(d),d.forEach(w),this.h()},h(){I(t,f)},m(n,d){M(n,t,d),o&&o.m(t,null),e=!0,r||(i=G(t,"click",a[4]),r=!0)},p(n,[d]){o&&o.p&&(!e||d&4)&&U(o,l,n,n[2],e?F(l,n[2],d,null):V(n[2]),null),I(t,f=J(c,[(!e||d&1&&s!==(s="box "+(n[0]?"aside":"")))&&{class:s},d&2&&n[1]]))},i(n){e||(Q(o,n),e=!0)},o(n){W(o,n),e=!1},d(n){n&&w(t),o&&o.d(n),r=!1,i()}}}function et(a,t,s){let{$$slots:e={},$$scope:r}=t,{aside:i=!1}=t;function l(o){$.call(this,a,o)}return a.$$set=o=>{s(1,t=T(T({},t),L(o))),"aside"in o&&s(0,i=o.aside),"$$scope"in o&&s(2,r=o.$$scope)},t=L(t),[i,t,r,e,l]}class ct extends B{constructor(t){super();K(this,t,et,tt,N,{aside:0})}}export{ct as B,nt as a,rt as b,lt as g};
//# sourceMappingURL=Box-760a3843.js.map
