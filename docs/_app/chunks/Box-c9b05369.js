var C=Object.defineProperty,w=Object.defineProperties;var P=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var k=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var O=(e,t,s)=>t in e?C(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,A=(e,t)=>{for(var s in t||(t={}))k.call(t,s)&&O(e,s,t[s]);if(R)for(var s of R(t))S.call(t,s)&&O(e,s,t[s]);return e},E=(e,t)=>w(e,P(t));import{V as I,S as p,i as N,s as B,K as H,C as T,e as K,c as D,a as Y,d as b,W as v,g as j,Q as M,L as G,M as U,N as V,z as F,q as J,o as Q,X as L,Y as W}from"./vendor-321789e9.js";import{d as h}from"./stores-b0039799.js";const m={MODE:"production",DEV:!1,PROD:!0,BASE_URL:"/_app/",API_ROOT:"https://api-lok-live.leagueofkingdoms.com/api",ETHERSCAN_API_ROOT:"https://api.etherscan.io/api",ETHERSCAN_API_KEY:"F9FJ7PFU1I1J22JQUAKXY8C2CQVMZGHRM3"},q=5e3,X=1,$=100,z=e=>new Promise(t=>setTimeout(()=>t(),e)),Z=async(e,t={},s)=>{let a=null,n;if(typeof AbortController=="function"){const{timeout:c=q}=t,i=new AbortController;a=setTimeout(()=>i.abort(),c),typeof s=="function"?n=await s(e,E(A({},t),{signal:i.signal})):n=await fetch(e,E(A({},t),{signal:i.signal}))}else typeof s=="function"?n=await s(e,t):n=await fetch(e,t);return a!==null&&clearTimeout(a),n},g=async(e,t={},s,a=X)=>{try{return await Z(e,t,s)}catch(n){if(console.error(n),a===1)throw n;return await z($),g(e,t,s,a-1)}},x={getContractABI:(e,t,s)=>g(`${m.ETHERSCAN_API_ROOT}?module=contract&action=getabi&address=${e}&page=1&startblock=0&sort=asc&apikey=${m.ETHERSCAN_API_KEY}`,s,t),getBalance:(e,t,s,a)=>g(`${m.ETHERSCAN_API_ROOT}?module=account&action=tokenbalance&contractaddress=${e}&address=${t}&tag=latest&&apikey=${m.ETHERSCAN_API_KEY}`,a,s),getTransferEvents:(e,t,s=!1,a,n)=>g(`${m.ETHERSCAN_API_ROOT}?module=account&action=${s?"tokennfttx":"tokentx"}&contractaddress=${e}&address=${t}&apikey=${m.ETHERSCAN_API_KEY}`,n,a)},y=(e,t,s,a,n)=>g(`${m.API_ROOT}/stat/land/contribution?landId=${e}&from=${t}&to=${s}`,n,a),lt=async(e,t)=>{let s=[],a=I(h),n=e||a.wallet,c=t||a.contract,i=await x.getTransferEvents(c,n,!0).catch(r=>console.error(r)),o=await(i==null?void 0:i.json().catch(r=>console.error(r)));return o.message==="OK"&&o.status==="1"&&Array.isArray(o.result)&&o.result.map(({tokenName:r,tokenSymbol:f,tokenID:l})=>{r==="League of Kingdoms LAND"&&f==="LOKL"&&s.push(l)}),s},nt=(e,t,s)=>{let a=I(h),n=e||a.lands,c=t||a.start,i=s||a.end;if(Array.isArray(a.data))if(a.data.length===0)a.data=[{start:c,end:i,data:{}}],a.data.map((o,r)=>{o.start===c&&o.end===i&&n.map(async f=>{let l=await y(f,c,i).catch(u=>console.error(u)),d=await(l==null?void 0:l.json().catch(u=>console.error(u)));typeof o.data=="undefined"&&(a.data[r].data={}),a.data[r].data[f]=d,h.set(a)})}),console.log("Loaded from server");else{let o=!1;a.data.map(r=>{r.start===c&&r.end===i&&(o=!0)}),o?a.data.map((r,f)=>{r.start===c&&r.end===i&&(r.data&&Object.keys(r.data).length===0?(n.map(async l=>{let d=await y(l,c,i).catch(_=>console.error(_)),u=await(d==null?void 0:d.json().catch(_=>console.error(_)));typeof r.data=="undefined"&&(a.data[f].data={}),a.data[f].data[l]=u,h.set(a)}),console.log("Loaded from server")):console.log("Loaded from cache"))}):(a.data.push({start:c,end:i,data:{}}),a.data.map((r,f)=>{r.start===c&&r.end===i&&n.map(async l=>{let d=await y(l,c,i).catch(_=>console.error(_)),u=await(d==null?void 0:d.json().catch(_=>console.error(_)));typeof r.data=="undefined"&&(a.data[f].data={}),a.data[f].data[l]=u,h.set(a)})}),console.log("Loaded from server"))}};function tt(e){let t,s,a,n,c;const i=e[3].default,o=H(i,e,e[2],null);let r=[{class:s="box "+(e[0]?"aside":"")},e[1]],f={};for(let l=0;l<r.length;l+=1)f=T(f,r[l]);return{c(){t=K("div"),o&&o.c(),this.h()},l(l){t=D(l,"DIV",{class:!0});var d=Y(t);o&&o.l(d),d.forEach(b),this.h()},h(){v(t,f)},m(l,d){j(l,t,d),o&&o.m(t,null),a=!0,n||(c=M(t,"click",e[4]),n=!0)},p(l,[d]){o&&o.p&&(!a||d&4)&&G(o,i,l,l[2],a?V(i,l[2],d,null):U(l[2]),null),v(t,f=F(r,[(!a||d&1&&s!==(s="box "+(l[0]?"aside":"")))&&{class:s},d&2&&l[1]]))},i(l){a||(J(o,l),a=!0)},o(l){Q(o,l),a=!1},d(l){l&&b(t),o&&o.d(l),n=!1,c()}}}function at(e,t,s){let{$$slots:a={},$$scope:n}=t,{aside:c=!1}=t;function i(o){W.call(this,e,o)}return e.$$set=o=>{s(1,t=T(T({},t),L(o))),"aside"in o&&s(0,c=o.aside),"$$scope"in o&&s(2,n=o.$$scope)},t=L(t),[c,t,n,a,i]}class rt extends p{constructor(t){super();N(this,t,at,tt,B,{aside:0})}}export{rt as B,nt as a,lt as g};
//# sourceMappingURL=Box-c9b05369.js.map
